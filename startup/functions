" vim:ft=vim:
if has("autocmd")
  filetype plugin indent on
  augroup vimrc
    au!

    "autocmd FileType text setlocal textwidth=78
    "autocmd BufReadPost *
          "\ if line("'\"") > 1 && line("'\"") <= line("$") |
          "\   exe "normal! g`\"" |
          "\ endif

    au BufRead,BufNewFile *.inc set ft=php
    au BufRead,BufNewFile *.install set ft=php
    au BufWritePost *.coffee silent CoffeeMake!
    au User plugin-template-loaded call s:template_keywords()
    au BufWritePost vimrc :so $MYVIMRC

    au VimLeave * :mks! ~/.lastvimsess
    "au VimEnter * :so! ~/.lastvimsess

  augroup END
else
  set autoindent " always set autoindenting on
endif " has("autocmd")


function! s:template_keywords()
  if search('${name}')
    silent %s/\${name}/\=expand('%:t:r')/g
  endif
  if search('${fullname}')
    silent %s/\${fullname}/\=expand('%:t')/g
  endif
  if search('${user}')
    silent %s/\${user}/Denis Blokhin/g
  endif
  if search('${date}')
    silent %s/\${date}/\=strftime('%Y-%m-%d')/g
  endif
  if search('${time}')
    silent %s/\${time}/\=strftime('%H:%M:%S')/g
  endif
endfunction
